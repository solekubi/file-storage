(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-33c592f2","chunk-23202726","chunk-64e5b3e9","chunk-2789b5d0","chunk-0c539388"],{"0feb":function(e,t,a){"use strict";a.d(t,"b",(function(){return s})),a.d(t,"f",(function(){return o})),a.d(t,"a",(function(){return c})),a.d(t,"c",(function(){return i})),a.d(t,"d",(function(){return u})),a.d(t,"e",(function(){return l})),a.d(t,"g",(function(){return d}));var r=a("b775"),n=a("365c");function s(e){return Object(r["b"])({url:n["b"].Permission+"/getPermList",data:e,method:"get"})}function o(e){return Object(r["b"])({url:n["b"].Permission+"/savePerm",data:e,method:"post"})}function c(e){return Object(r["b"])({url:n["b"].Permission+"/delPerm",data:e,method:"post"})}function i(e){return Object(r["b"])({url:n["b"].Permission+"/getPermSettingList",data:e,method:"get"})}function u(e){return Object(r["b"])({url:n["b"].Permission+"/getRoleList",data:e,method:"get"})}function l(e){return Object(r["b"])({url:n["b"].Permission+"/getUserList",data:e,method:"get"})}function d(e){return Object(r["b"])({url:n["b"].Permission+"/savePermSetting",data:e,method:"post"})}},"1bea":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"save"},on:{click:e.handleSave}},[e._v("保存权限")])],1),a("a-row",{attrs:{gutter:24}},[e.showUser?a("a-col",{attrs:{span:5}},[a("users",{ref:"users",on:{doSearchUserPerm:e.doSearchUserPerm}})],1):e._e(),a("a-col",{attrs:{span:5}},[a("roles",{ref:"roles",attrs:{showOp:!e.showUser,roleQueryParam:e.roleQueryParam},on:{doSearchRolePerm:e.doSearchRolePerm}})],1),a("a-col",{attrs:{span:e.showUser?14:18}},[a("s-table",{ref:"permTable",attrs:{columns:e.permColumns,"load-data":e.loadPermData,showRowNum:e.showUser,multiSelect:!e.showUser,"first-load":!e.showUser,"query-param":e.permQueryParam,afterSearch:e.afterSearch}})],1)],1)],1)},n=[],s=(a("4160"),a("159b"),a("2af9")),o=a("8cbc"),c=a("9c8b"),i=a("0feb"),u={name:"PermSelect",components:{STable:s["g"],Roles:o["default"],Users:c["default"]},props:{showUser:{type:Boolean,default:!0}},data:function(){return{permQueryParam:{roleId:"",userId:""},roleQueryParam:{userId:""},permColumns:[{title:"名称",dataIndex:"name",searchable:!0,scopedSlots:{customRender:"name"}},{title:"编码",dataIndex:"permission",searchable:!0,scopedSlots:{customRender:"permission"}},{title:"描述",dataIndex:"description",scopedSlots:{customRender:"description"}}]}},methods:{loadPermData:function(e){return Object(i["c"])(e).then((function(e){return e.result}))},doSearchUserPerm:function(e){this.roleQueryParam.userId=e,this.$refs.roles.$refs.roleTable.doSearch(),this.permQueryParam.userId=e,this.$refs.permTable.doSearch()},doSearchRolePerm:function(e){this.permQueryParam.roleId=e,this.$refs.permTable.doSearch()},afterSearch:function(e,t){e.selectedRowKeys=[],e.selectedRows=[],t.forEach((function(t){t.enabled&&e.selectedRowKeys.push(t.id)&&e.selectedRows.push(t)}))},handleSave:function(){var e=this,t=this.showUser?"user_perm":"role_perm",a=this.showUser?this.$refs.users.$refs.userTable.selectedRowKeys:[],r=this.$refs.roles.$refs.roleTable.selectedRowKeys;return this.showUser&&0===a.length?(this.$notification.warn({message:"提示",description:"请至少勾选一条用户记录",duration:4}),!1):this.showUser||0!==r.length?void Object(i["g"])({type:t,userIds:a,roleIds:r,permIds:this.$refs.permTable.selectedRowKeys}).then((function(t){e.$notification.success({message:"成功",description:t.message,duration:4}),e.$refs.permTable.refresh()})):(this.$notification.warn({message:"提示",description:"请至少勾选一条角色记录",duration:4}),!1)}}},l=u,d=a("2877"),f=Object(d["a"])(l,r,n,!1,null,null,null);t["default"]=f.exports},"4e2b":function(e,t,a){},6024:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.addRec()}}},[e._v("新建")]),a("a-button",{attrs:{type:"danger",icon:"delete"},on:{click:function(t){return e.handleDel(e.$refs.permTable.selectedRowKeys)}}},[e._v("删除")])],1),a("s-table",{ref:"permTable",attrs:{columns:e.columns,"load-data":e.loadData,dataSource:e.dataSource,multiSelect:!0},on:{"update:dataSource":function(t){e.dataSource=t},"update:data-source":function(t){e.dataSource=t}},scopedSlots:e._u([{key:"serial",fn:function(t,r,n){return a("span",{},[e._v(" "+e._s(e.queryParam.pageSize*(e.queryParam.pageNo-1)+n+1)+" ")])}},e._l(["name","permission","description"],(function(t){return{key:t,fn:function(r,n){return[a("span",{key:t},[n.editable?a("a-input",{staticStyle:{margin:"-5px 0"},attrs:{size:"small",value:n[t]},on:{"update:value":function(a){return e.$set(n,t,a)},change:function(a){return e.handleChange(a.target.value,n.id,t)}}}):[e._v(e._s(r)+" ")]],2)]}}})),{key:"status",fn:function(t,r){return a("span",{},[a("sample-switch",{attrs:{value:r.status,disabled:!r.editable},on:{"update:value":function(t){return e.$set(r,"status",t)}}})],1)}},{key:"action",fn:function(t,r){return a("span",{},[r.editable?[a("a",{on:{click:function(t){return e.handleSave(r)}}},[e._v("保存")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否要取消编辑此行？"},on:{confirm:function(t){return e.handleCancel(r.id)}}},[a("a",[e._v("取消")])])]:[a("a",{on:{click:function(t){return e.handleEdit(r.id)}}},[e._v("修改")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-popconfirm",{attrs:{title:"是否要删除此行？",placement:"right"},on:{confirm:function(t){return e.handleDel([r.id])}}},[a("a",[e._v("删除")])])]],2)}}],null,!0)})],1)},n=[],s=(a("4de4"),a("c740"),a("caad"),a("a434"),a("d3b7"),a("2532"),a("2af9")),o=a("ca00"),c=a("0feb"),i=a("c1df"),u=a.n(i),l={name:"PermList",components:{STable:s["g"]},data:function(){return{queryParam:{},dataSource:[],columns:[{title:"#",scopedSlots:{customRender:"serial"}},{title:"名称",dataIndex:"name",scopedSlots:{customRender:"name"}},{title:"编码",dataIndex:"permission",scopedSlots:{customRender:"permission"}},{title:"状态",dataIndex:"status",scopedSlots:{filterIcon:"filterIcon",customRender:"status"},filters:[{text:"启用",value:"1"},{text:"禁用",value:"0"}]},{title:"描述",dataIndex:"description",scopedSlots:{customRender:"description"}},{title:"创建时间",dataIndex:"create_date"},{title:"操作",dataIndex:"action",scopedSlots:{customRender:"action"}}]}},methods:{doSearch:function(){this.$refs.permTable.doSearch(this.queryParam)},addRec:function(){this.dataSource.splice(0,0,{id:"add_"+u.a.now(),name:"",status:"1",permission:"",create_date:Object(o["a"])(u()()),description:"",editable:!0})},handleCancel:function(e){e.includes("add_")?this.dataSource.splice(this.dataSource.findIndex((function(t){return t.id===e})),1):(delete this.dataSource.filter((function(t){return t.id===e}))[0].editable,this.$forceUpdate())},handleSave:function(e){var t=this,a=this;Object(c["f"])(e).then((function(r){a.$message.success(r.message),t.dataSource.filter((function(t){return t.id===e.id}))[0].id=r.result.id,t.handleCancel(r.result.id)}))},handleEdit:function(e){this.dataSource.filter((function(t){return t.id===e}))[0].editable=!0,this.$forceUpdate()},handleDel:function(e){var t=this,a=this;if(0===e.length)return this.$notification["warning"]({message:"提示",description:"请先勾选一条记录",duration:4}),!1;var r=a.$refs.permTable.selectedRowKeys;r.length===e.length?a.$confirm({title:"删除?",content:"是否要删除勾选的行？",onOk:function(){return new Promise((function(t,r){Object(c["a"])({ids:e}).then((function(e){a.$message.success(e.message),a.$refs.permTable.clearSelected(),a.doSearch(),t()}))})).catch((function(){}))}}):Object(c["a"])({ids:e}).then((function(e){t.$message.success(e.message),t.doSearch()}))},handleChange:function(e,t,a){this.dataSource.filter((function(e){return e.id===t}))[0][a]=e,this.$forceUpdate()},loadData:function(e){return this.queryParam=Object.assign(this.queryParam,e),Object(c["b"])(Object.assign({},this.queryParam,{create_date:Object(o["a"])(this.queryParam.create_date)})).then((function(e){return e.result}))}}},d=l,f=(a("673e"),a("2877")),m=Object(f["a"])(d,r,n,!1,null,"5146e3ea",null);t["default"]=m.exports},"673e":function(e,t,a){"use strict";var r=a("4e2b"),n=a.n(r);n.a},"8cbc":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("s-table",{ref:"roleTable",attrs:{columns:e.roleColumns,"load-data":e.loadRoleData,multiSelect:!0,"page-size":-1,showRowNum:!1,dataSource:e.dataSource,"query-param":e.roleQueryParam,afterSearch:e.afterSearch},on:{"update:dataSource":function(t){e.dataSource=t},"update:data-source":function(t){e.dataSource=t}},scopedSlots:e._u([{key:"role_name",fn:function(t,r){return a("span",{},[e.showOp?a("a-tooltip",{attrs:{placement:"right",title:"点击查看角色权限"}},[a("a",{style:{color:r.isClick?"#ff1818":"#1890ff"},on:{click:function(t){return e.doSearchRolePerm(r)}}},[e._v(e._s(r.role_name))])]):a("span",{domProps:{textContent:e._s(r.role_name)}})],1)}}])})},n=[],s=(a("4160"),a("159b"),a("2af9")),o=a("0feb"),c={name:"Roles",components:{STable:s["g"]},props:{show:{type:Boolean,default:!0},showOp:{type:Boolean,default:!0},selectedRowKeys:{type:Array,default:function(){return[]}},selectedRows:{type:Array,default:function(){return[]}},roleQueryParam:{type:Object,default:function(){return{}}}},data:function(){return{dataSource:[],roleColumns:[{title:"角色",dataIndex:"role_name",searchable:!0,scopedSlots:{customRender:"role_name"}}]}},methods:{loadRoleData:function(e){return Object(o["d"])(e).then((function(e){return e.result}))},afterSearch:function(e,t){e.selectedRowKeys=[],e.selectedRows=[],t.forEach((function(t){t.enabled&&e.selectedRowKeys.push(t.id)&&e.selectedRows.push(t)}))},doSearchRolePerm:function(e){this.dataSource.forEach((function(e){return e.isClick&&delete e.isClick})),this.$set(e,"isClick",!0),this.$emit("doSearchRolePerm",e.id)}}},i=c,u=a("2877"),l=Object(u["a"])(i,r,n,!1,null,null,null);t["default"]=l.exports},"9c8b":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("s-table",{ref:"userTable",attrs:{columns:e.userColumns,"load-data":e.loadUserData,multiSelect:!0,showRowNum:!1,"query-param":e.userQueryParam,dataSource:e.dataSource,pagination:{size:"small",simple:!0}},on:{"update:dataSource":function(t){e.dataSource=t},"update:data-source":function(t){e.dataSource=t}},scopedSlots:e._u([{key:"user_name",fn:function(t,r){return a("span",{},[a("a-tooltip",{attrs:{placement:"right",title:"点击查看用户权限"}},[a("a",{style:{color:r.isClick?"#ff1818":"#1890ff"},on:{click:function(t){return e.doSearchUserPerm(r)}}},[e._v(e._s(r.user_name))])])],1)}}])})},n=[],s=(a("4160"),a("159b"),a("2af9")),o=a("0feb"),c={name:"Users",components:{STable:s["g"]},data:function(){return{dataSource:[],userQueryParam:{},userColumns:[{title:"用户名",dataIndex:"user_name",searchable:!0,scopedSlots:{customRender:"user_name"}}]}},methods:{loadUserData:function(e){return Object(o["e"])(e).then((function(e){return e.result}))},doSearchUserPerm:function(e){this.dataSource.forEach((function(e){return e.isClick&&delete e.isClick})),this.$set(e,"isClick",!0),this.$emit("doSearchUserPerm",e.id)}}},i=c,u=a("2877"),l=Object(u["a"])(i,r,n,!1,null,"6dad4ab2",null);t["default"]=l.exports},d4a3:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",[a("a-tabs",{attrs:{defaultActiveKey:e.activeKey,tabPosition:e.isDesktop()?"left":"top"},on:{tabClick:e.tabClick}},[a("a-tab-pane",{key:"1"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"ordered-list"}}),e._v(" 权限列表 ")],1),a("perm-list")],1),a("a-tab-pane",{key:"2"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"setting"}}),e._v(" 角色配权 ")],1),a("perm-setting",{attrs:{showUser:!1}})],1),a("a-tab-pane",{key:"3"},[a("span",{attrs:{slot:"tab"},slot:"tab"},[a("a-icon",{attrs:{type:"setting"}}),e._v(" 用户配权 ")],1),a("perm-setting")],1)],1)],1)},n=[],s=a("ac0d"),o=a("1bea"),c=a("6024"),i={components:{PermSetting:o["default"],PermList:c["default"]},mixins:[s["c"]],data:function(){return{ls_activeKey:"PERMISSION_ACTIVE_TAB_KEY",activeKey:"1"}},created:function(){this.activeKey=this.$ls.get(this.ls_activeKey)||"1"},methods:{tabClick:function(e){this.$ls.set(this.ls_activeKey,e)}}},u=i,l=a("2877"),d=Object(l["a"])(u,r,n,!1,null,null,null);t["default"]=d.exports}}]);